# Canvas Studio 前端测试用例（第一版占位）

## 范围
- 画布基础：节点/边渲染、缩放、拖拽放置。
- 工具栏与节点选择器：添加节点（点击/拖拽）、模式切换、整理布局。
- 撤销/重做：历史快照。
- 右侧面板：节点头部样式、空状态提示。
- 运行态 UI：状态标签/圆点、进度条、失败提示。
- 边配置/运行历史/Toast/SSE/持久化：占位可见性。

## 用例列表

### 1. 节点添加（点击）
前置：打开画布，左侧工具栏可见。  
步骤：点击工具栏“添加节点”按钮，选择“ComfyUI 图片”。  
期望：画布上出现标题“ComfyUI 图片”的节点，位置偏移合理（不叠加），历史快照可用（Undo 可撤销）。

### 2. 节点添加（拖拽）
前置：同上。  
步骤：在节点选择器内拖拽“ComfyUI 视频”到画布中央后释放。  
期望：节点落点与拖拽释放位置一致（经 ReactFlow project 计算），节点标题为“ComfyUI 视频”，支持 Undo 撤销。

### 3. 撤销/重做
前置：已添加至少两个节点。  
步骤：依次点击撤销两次，随后重做两次。  
期望：节点数量与位置按历史快照回滚/恢复，撤销/重做按钮禁用态正确。

### 4. 节点运行态展示
前置：选中任意节点，手动修改其 runtime（可在调试控制台调用 store）：
`useWorkflowStore.getState().setNodes(ns => ns.map(n => n.id===targetId ? {...n, data:{...n.data, runtime:{status:'failed', progress:45, message:'出错信息'}}}:n))`
步骤：观察节点卡片。  
期望：左上圆点为红色系，状态标签文案“失败”，进度条显示 45%，错误提示面板展示“出错信息”。

### 5. 节点状态切换样式
前置：同上，分别设置 runtime.status 为 idle/queued/running/succeeded/canceled。  
期望：状态圆点与标签色随状态变化（灰/琥珀/天蓝/绿色/石板灰），标签文字对应中文文案。

### 6. 右侧配置面板（空/选中态）
前置：无节点选中。  
步骤：查看右侧固定面板；选中任意节点后再查看。  
期望：未选中时显示“选择节点以编辑配置”；选中后展示标题、类型徽标、状态标签、右侧操作按钮（运行/帮助/关闭），表单区域显示占位文案。

### 7. 边样式与标签
前置：在画布连接两节点生成边；手动设置边 data.mode。  
步骤：设置 mode='manual' 与 mode='auto' 分别观察。  
期望：边为 smoothstep，末端箭头可见；标签显示“手动/自动”，颜色随模式变化，选中时线宽变粗变蓝。

### 8. 节点选择器浮层样式
前置：打开节点选择器。  
步骤：检查搜索框、分组卡片、类型徽标；移动鼠标悬停条目。  
期望：浮层圆角+细边框+阴影，条目 hover 高亮，分类标题为大写浅灰，搜索框图标正常。

### 9. 持久化占位（本地存储）
前置：添加节点并刷新页面。  
步骤：手动调用 `useCanvasPersist().load()`（或在控制台模拟）；  
期望：能够从 localStorage 恢复节点/边（当前为占位，本地存储可见）。

### 10. Toast 占位
前置：在控制台调用 `useToast().add('测试 Toast')`。  
期望：右下出现 Toast 卡片，约 3s 自动消失。

### 11. 运行历史/边配置占位
前置：打开运行历史面板占位和边配置面板占位（手动渲染组件）。  
期望：组件可渲染，无样式异常，文案提示“TODO/占位”。

### 12. 快捷键占位
前置：在当前实现中，Undo/Redo 快捷键有效，其余快捷键为占位。  
步骤：Ctrl+Z / Ctrl+Y；尝试 V/H/Delete/Ctrl+A。  
期望：Undo/Redo 生效；其他快捷键无报错（占位未实现）。

## 说明
- 带“占位”标记的用例仅验证 UI/骨架可渲染，不验证真实业务逻辑。
- 如需批量操作，可在浏览器控制台调用 Zustand store/Hooks 进行状态注入以模拟后端事件。***
